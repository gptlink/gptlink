var e=Object.defineProperty,l=Object.defineProperties,o=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(l,o,a)=>o in l?e(l,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[o]=a,n=(e,l)=>{for(var o in l||(l={}))s.call(l,o)&&r(e,o,l[o]);if(a)for(var o of a(l))t.call(l,o)&&r(e,o,l[o]);return e};import{c as d,f as i}from"./index.079657ab.js";import{u as p}from"./useBasicForm.485b6e25.js";import{d as u,r as c,o as m,h as f,i as b,c as g,f as _,w as y,b as h,u as v,ao as w,s as q,az as k,av as x,e as I,g as P,E as O}from"./vendor.e53bfd87.js";import{_ as j,a as C}from"./index.82c1a35e.js";import{t as V}from"./toolbarKeys.efa257c4.js";const z=[{field:"name",component:"Input",label:"站点名称",required:!1,componentProps:{placeholder:"输入网址名称"}},{field:"icp",component:"Input",label:"网站底部icp备案号",required:!1,componentProps:{placeholder:"请输入icp备案号"}},{field:"web_logo",component:"Input",label:"用户端LOGO",required:!1,slot:"web_logo"},{field:"admin_logo",component:"Input",label:"管理端LOGO",required:!1,slot:"admin_logo"},{field:"user_logo",component:"Input",label:"用户默认头像",required:!1,slot:"user_logo"}],U=[{field:"enable",component:"Switch",label:"是否启用",required:!0},{field:"title",component:"Input",label:"协议标题",required:!0,componentProps:{placeholder:"请输入协议标题"}},{field:"agreement",component:"Input",label:"协议内容",required:!0,slot:"agreement"}],K=[{field:"title",component:"Input",label:"微信分享标题",required:!1,componentProps:{placeholder:"请输入协议标题"}},{field:"desc",component:"Input",label:"微信分享描述",required:!1,componentProps:{placeholder:"请输入协议标题"}},{field:"img_url",component:"Input",label:"微信分享图",required:!1,slot:"img_url"},{field:"share_img",component:"Input",label:"分享海报",required:!1,slot:"share_img"}],L=[{field:"enable",component:"Switch",label:"是否启用",required:!0},{field:"keywords",component:"Input",label:"关键词",required:!0,componentProps:{placeholder:'使用json格式传入，用户发送的对话包含关键词将被拒绝回答，示例：["xxx", "xxx2", "xxx3"]',type:"textarea",rows:15}}],S=[{field:"enable",component:"Switch",label:"是否启用",required:!0},{field:"open",component:"Switch",label:"开放用户申请",required:!0},{field:"ratio",component:"Input",label:"佣金比例",required:!0,componentProps:{placeholder:"输入佣金比例，整数",type:"number"}},{field:"rules",component:"Input",label:"佣金规则说明",required:!0,slot:"rules"}];const F={class:"cb-page"},R={class:"cb-m-b-40"},D={class:"open-upload cb-flex"},E=["src"],G={key:2,class:"open-upload-mask"},T={class:"open-upload cb-flex"},A=["src"],B={key:2,class:"open-upload-mask"},H={class:"open-upload cb-flex"},J=["src"],M={key:2,class:"open-upload-mask"},N={class:"open-upload cb-flex"},Q=["src"],W={key:2,class:"open-upload-mask"},X={class:"open-upload cb-flex"},Y=["src"],Z={key:2,class:"open-upload-mask"},$={class:"cb-m-l-60"},ee=P("确认");var le=j(u({__name:"system",setup(e){const a=c("5"),s=c([{value:"5",name:"系统配置"},{value:"6",name:"协议配置"},{value:"8",name:"关键词配置"},{value:"9",name:"分享配置"},{value:"10",name:"分销配置"}]),{register:t,validate:r,setFieldsValue:u,resetFields:P,setProps:j}=p({options:{labelCol:{span:6},wrapperCol:{span:6}},schemas:z});m((()=>{ae()}));const le=e=>{P();j({schemas:{5:z,6:U,8:L,9:K,10:S}[e]}),setTimeout((()=>{ae()}),50)},oe=async()=>{try{const e=await r(),l={type:a.value,config:n({},e)},{err_code:o}=await C().open.openConfig(l);o||O.success("保存成功")}catch(e){}},ae=async()=>{try{const{data:t}=await C().open.getConfig({type:a.value});"5"===a.value&&(t.config=(e=n({},t.config),s={admin_logo:t.config.admin_logo,web_logo:t.config.web_logo,user_logo:t.config.user_logo},l(e,o(s)))),u(n({},t.config))}catch(t){}var e,s},se=async(e,l)=>{const o=await ne(e);u({[l]:o})},te=async e=>await ne(e),re=e=>{u({[e]:""})},ne=e=>new Promise(((l,o)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=e=>{l(e.target.result)}}));return(e,l)=>{const o=f("CbTab"),r=f("el-icon"),n=f("el-button"),p=f("el-card");return b(),g("div",F,[_(p,{class:"open-main"},{default:y((()=>[h("div",R,[_(o,{tabs:s.value,modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),onChange:le},null,8,["tabs","modelValue"])]),_(v(d),{onRegister:v(t)},{web_logo:y((({model:e,field:o})=>[_(v(w),{"show-file-list":!1,"http-request":()=>{},"before-upload":e=>se(e,"web_logo")},{default:y((()=>[h("div",D,[e[o]?(b(),g("img",{key:0,src:e[o],class:"open-upload-img"},null,8,E)):(b(),q(r,{key:1,class:"avatar-uploader-icon",size:30},{default:y((()=>[_(v(k))])),_:1})),e[o]?(b(),g("div",G,[_(r,{color:"#fff",class:"open-upload-del",size:26,onClick:l[1]||(l[1]=e=>re("web_logo"))},{default:y((()=>[_(v(x))])),_:1})])):I("",!0)])])),_:2},1032,["http-request","before-upload"])])),admin_logo:y((({model:e,field:o})=>[_(v(w),{"show-file-list":!1,"http-request":()=>{},"before-upload":e=>se(e,"admin_logo")},{default:y((()=>[h("div",T,[e[o]?(b(),g("img",{key:0,src:e[o],class:"open-upload-img"},null,8,A)):(b(),q(r,{key:1,class:"avatar-uploader-icon",size:30},{default:y((()=>[_(v(k))])),_:1})),e[o]?(b(),g("div",B,[_(r,{color:"#fff",class:"open-upload-del",size:26,onClick:l[2]||(l[2]=e=>re("admin_logo"))},{default:y((()=>[_(v(x))])),_:1})])):I("",!0)])])),_:2},1032,["http-request","before-upload"])])),user_logo:y((({model:e,field:o})=>[_(v(w),{"show-file-list":!1,"http-request":()=>{},"before-upload":e=>se(e,"user_logo")},{default:y((()=>[h("div",H,[e[o]?(b(),g("img",{key:0,src:e[o],class:"open-upload-img"},null,8,J)):(b(),q(r,{key:1,class:"avatar-uploader-icon",size:30},{default:y((()=>[_(v(k))])),_:1})),e[o]?(b(),g("div",M,[_(r,{color:"#fff",class:"open-upload-del",size:26,onClick:l[3]||(l[3]=e=>re("user_logo"))},{default:y((()=>[_(v(x))])),_:1})])):I("",!0)])])),_:2},1032,["http-request","before-upload"])])),img_url:y((({model:e,field:o})=>[_(v(w),{"show-file-list":!1,"http-request":()=>{},"before-upload":e=>se(e,"img_url")},{default:y((()=>[h("div",N,[e[o]?(b(),g("img",{key:0,src:e[o],class:"open-upload-img"},null,8,Q)):(b(),q(r,{key:1,class:"avatar-uploader-icon",size:30},{default:y((()=>[_(v(k))])),_:1})),e[o]?(b(),g("div",W,[_(r,{color:"#fff",class:"open-upload-del",size:26,onClick:l[4]||(l[4]=e=>re("img_url"))},{default:y((()=>[_(v(x))])),_:1})])):I("",!0)])])),_:2},1032,["http-request","before-upload"])])),share_img:y((({model:e,field:o})=>[_(v(w),{"show-file-list":!1,"http-request":()=>{},"before-upload":e=>se(e,"share_img")},{default:y((()=>[h("div",X,[e[o]?(b(),g("img",{key:0,src:e[o],class:"open-upload-img"},null,8,Y)):(b(),q(r,{key:1,class:"avatar-uploader-icon",size:30},{default:y((()=>[_(v(k))])),_:1})),e[o]?(b(),g("div",Z,[_(r,{color:"#fff",class:"open-upload-del",size:26,onClick:l[5]||(l[5]=e=>re("share_img"))},{default:y((()=>[_(v(x))])),_:1})])):I("",!0)])])),_:2},1032,["http-request","before-upload"])])),agreement:y((({model:e,field:l})=>[_(v(i),{modelValue:e[l],"onUpdate:modelValue":o=>e[l]=o,useLibrary:!1,"http-request":te,toolbarKeys:v(V)},null,8,["modelValue","onUpdate:modelValue","toolbarKeys"])])),rules:y((({model:e,field:l})=>[_(v(i),{modelValue:e[l],"onUpdate:modelValue":o=>e[l]=o,useLibrary:!1,"http-request":te,toolbarKeys:v(V)},null,8,["modelValue","onUpdate:modelValue","toolbarKeys"])])),_:1},8,["onRegister"]),h("div",$,[_(n,{type:"primary",onClick:oe},{default:y((()=>[ee])),_:1})])])),_:1})])}}}),[["__scopeId","data-v-69c047c8"]]);export{le as default};
